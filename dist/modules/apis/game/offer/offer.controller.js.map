{"version":3,"sources":["../../../../../src/modules/apis/game/offer/offer.controller.ts"],"sourcesContent":["// NestJS\r\nimport {\r\n  Body,\r\n  Controller,\r\n  Delete,\r\n  Get,\r\n  HttpCode,\r\n  Param,\r\n  ParseIntPipe,\r\n  Post,\r\n  Put,\r\n  Query,\r\n  UseGuards,\r\n  UseInterceptors,\r\n} from '@nestjs/common';\r\n\r\n// Multer\r\nimport { AnyFilesInterceptor } from '@nest-lab/fastify-multer';\r\n\r\n// Decorators\r\nimport { ApiDescriptor } from '@decorators/api-descriptor.decorator';\r\nimport { Serialize } from '@decorators/serialize.decorator';\r\nimport { ApiTags } from '@nestjs/swagger';\r\n\r\n// Pipes\r\nimport { ParseJsonPipe } from '@pipes/parse-json.pipe';\r\nimport { UnionTypeValidationPipe } from '@pipes/union-type-validation.pipe';\r\n\r\n// Guards\r\nimport { AdminGuard } from '@guards/admin.guard';\r\nimport { JwtAccessAuthGuard } from '@guards/jwt-access-auth.guard';\r\n\r\n// Services\r\nimport { OfferService } from '@apis/game/offer/offer.service';\r\n\r\n// Body DTOs\r\nimport { CreateOfferDto } from '@apis/game/offer/dtos/create-offer.dto';\r\nimport { UpdateOfferDto } from '@apis/game/offer/dtos/update-offer.dto';\r\n\r\n// Query DTOs\r\nimport { OfferQueryDto } from '@apis/game/offer/dtos/offer-search-query.dto';\r\n\r\n// Serializer DTOs\r\nimport { PaginatedGamesDataDto } from '@apis/game/serializer-dtos/paginated-games-data.dto';\r\n\r\n// importing swagger descriptors\r\nimport { createOfferDescriptor } from '@apis/game/offer/api-descriptors/create-offer.descriptor';\r\nimport { deleteOfferDescriptor } from '@apis/game/offer/api-descriptors/delete-offer.descriptor';\r\nimport { getOffersPaginatedDescriptor } from '@apis/game/offer/api-descriptors/get-offers-paginated.descriptor';\r\nimport { updateOfferDescriptor } from '@apis/game/offer/api-descriptors/update-offer.descriptor';\r\n\r\n@ApiTags('Game Offer')\r\n@Controller('game/offer')\r\nexport class OfferController {\r\n  constructor(private readonly offerService: OfferService) {}\r\n\r\n  @ApiDescriptor(createOfferDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard, AdminGuard)\r\n  @UseInterceptors(AnyFilesInterceptor())\r\n  @Post()\r\n  @HttpCode(201)\r\n  async create(@Body() body: CreateOfferDto) {\r\n    const result = await this.offerService.createOffer(body);\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(getOffersPaginatedDescriptor)\r\n  @Serialize(PaginatedGamesDataDto)\r\n  @Get('paginated')\r\n  @HttpCode(200)\r\n  async getOffersPaginated(\r\n    @Query('page', ParseIntPipe) page: number,\r\n    @Query('limit', ParseIntPipe) limit: number,\r\n    @Query(\r\n      'orderBy',\r\n      new UnionTypeValidationPipe([\r\n        'id',\r\n        'name',\r\n        'discountPrice',\r\n        'basePrice',\r\n        'discountPercentage',\r\n        'offerType',\r\n        'discountStartDate',\r\n        'discountEndDate',\r\n      ]),\r\n    )\r\n    orderBy:\r\n      | 'id'\r\n      | 'name'\r\n      | 'discountPrice'\r\n      | 'basePrice'\r\n      | 'discountPercentage'\r\n      | 'offerType'\r\n      | 'discountStartDate'\r\n      | 'discountEndDate',\r\n    @Query('order', new UnionTypeValidationPipe(['ASC', 'DESC'])) order: 'ASC' | 'DESC',\r\n    @Query('searchQuery', new ParseJsonPipe(OfferQueryDto, { optional: true, validate: true }))\r\n    searchQuery: OfferQueryDto = {},\r\n  ) {\r\n    const result = await this.offerService.getOffersPaginated(page, limit, orderBy, order, searchQuery, true);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(updateOfferDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard, AdminGuard)\r\n  @Put(':id')\r\n  @HttpCode(200)\r\n  async updateOffer(@Param('id', ParseIntPipe) id: number, @Body() body: UpdateOfferDto) {\r\n    const result = await this.offerService.updateOffer({ id, ...body });\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(deleteOfferDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard, AdminGuard)\r\n  @Delete('/:id')\r\n  @HttpCode(200)\r\n  async deleteOffer(@Param('id', ParseIntPipe) id: number) {\r\n    const result = await this.offerService.delete(id);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n}\r\n"],"names":["OfferController","constructor","offerService","create","body","result","createOffer","getOffersPaginated","page","limit","orderBy","order","searchQuery","updateOffer","id","deleteOffer","delete","UnionTypeValidationPipe","ParseJsonPipe","OfferQueryDto","optional","validate"],"mappings":"AAAA,SAAS;;;;;+BAqDIA;;;eAAAA;;;wBAvCN;+BAG6B;wCAGN;oCACJ;yBACF;+BAGM;yCACU;4BAGb;oCACQ;8BAGN;gCAGE;gCACA;qCAGD;uCAGQ;uCAGA;uCACA;8CACO;uCACP;;;;;;;;;;;;;;;AAI/B,IAAA,AAAMA,kBAAN,MAAMA;IACXC,YAAY,AAAiBC,YAA0B,CAAE;aAA5BA,eAAAA;IAA6B;IAE1D,MAKMC,OAAO,AAAQC,IAAoB,EAAE;QACzC,MAAMC,SAAS,MAAM,IAAI,CAACH,YAAY,CAACI,WAAW,CAACF;QACnD,oBAAoB;QACpB,OAAOC;IACT;IAEA,MAIME,mBACJ,AAA6BC,IAAY,EACzC,AAA8BC,KAAa,EAC3C,AAaAC,OAQqB,EACrB,AAA8DC,KAAqB,EACnF,AACAC,cAA6B,CAAC,CAAC,EAC/B;QACA,MAAMP,SAAS,MAAM,IAAI,CAACH,YAAY,CAACK,kBAAkB,CAACC,MAAMC,OAAOC,SAASC,OAAOC,aAAa;QAEpG,oBAAoB;QACpB,OAAOP;IACT;IAEA,MAIMQ,YAAY,AAA2BC,EAAU,EAAE,AAAQV,IAAoB,EAAE;QACrF,MAAMC,SAAS,MAAM,IAAI,CAACH,YAAY,CAACW,WAAW,CAAC;YAAEC;YAAI,GAAGV,IAAI;QAAC;QAEjE,oBAAoB;QACpB,OAAOC;IACT;IAEA,MAIMU,YAAY,AAA2BD,EAAU,EAAE;QACvD,MAAMT,SAAS,MAAM,IAAI,CAACH,YAAY,CAACc,MAAM,CAACF;QAE9C,oBAAoB;QACpB,OAAOT;IACT;AACF;;;;;;;;;;;;;;;;;;;;;mDAnDUY,gDAAuB,CAAC;QAC1B;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;iDAWiBA,gDAAuB,CAAC;QAAC;QAAO;KAAO;uDACjCC,4BAAa,CAACC,kCAAa,EAAE;QAAEC,UAAU;QAAMC,UAAU;IAAK"}