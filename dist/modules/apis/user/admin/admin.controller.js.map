{"version":3,"sources":["../../../../../src/modules/apis/user/admin/admin.controller.ts"],"sourcesContent":["// NestJS\r\nimport { Body, Controller, Delete, Get, HttpCode, Param, ParseIntPipe, Put, Query, UseGuards } from '@nestjs/common';\r\n\r\n// Decorators\r\nimport { Serialize } from '@decorators/serialize.decorator';\r\n\r\n// Swagger\r\nimport { ApiDescriptor } from '@decorators/api-descriptor.decorator';\r\nimport { ApiTags } from '@nestjs/swagger';\r\n\r\n// Pipes\r\nimport { ParseJsonPipe } from '@pipes/parse-json.pipe';\r\nimport { UnionTypeValidationPipe } from '@pipes/union-type-validation.pipe';\r\n\r\n// Guards\r\nimport { AdminGuard } from '@guards/admin.guard';\r\nimport { JwtAccessAuthGuard } from '@guards/jwt-access-auth.guard';\r\n\r\n// Services\r\nimport { AdminService } from '@apis/user/admin/admin.service';\r\n\r\n// Body DTOs\r\nimport { UpdateUserDto } from '@apis/user/admin/dtos/update-user.dto';\r\n\r\n// Query DTOs\r\nimport { UserQueryDto } from '@apis/user/admin/dtos/user-search-query.dto';\r\n\r\n// Serializer DTOs\r\nimport { PaginatedUsersDataDto } from '@apis/user/serializer-dtos/paginated-users-data.dto';\r\n\r\n// Swagger descriptors\r\nimport { deleteUserDescriptor } from '@apis/user/admin/api-descriptors/delete-user.descriptor';\r\nimport { getUsersPaginatedDescriptor } from '@apis/user/admin/api-descriptors/get-users-paginated.descriptor';\r\nimport { updateUserDescriptor } from '@apis/user/admin/api-descriptors/update-user.descriptor';\r\n\r\n@ApiTags('User Admin')\r\n@Controller('user/admin')\r\nexport class AdminController {\r\n  constructor(private readonly admin: AdminService) {}\r\n\r\n  @ApiDescriptor(getUsersPaginatedDescriptor)\r\n  @Serialize(PaginatedUsersDataDto)\r\n  @Get('paginated')\r\n  @HttpCode(200)\r\n  async getUsersPaginated(\r\n    @Query('page', ParseIntPipe) page: number,\r\n    @Query('limit', ParseIntPipe) limit: number,\r\n    @Query(\r\n      'orderBy',\r\n      new UnionTypeValidationPipe(['username', 'email', 'country', 'isVerified', 'isAdmin', 'createdAt']),\r\n    )\r\n    orderBy: 'username' | 'email' | 'country' | 'isVerified' | 'isAdmin' | 'createdAt',\r\n    @Query('order', new UnionTypeValidationPipe(['ASC', 'DESC'])) order: 'ASC' | 'DESC',\r\n    @Query('searchQuery', new ParseJsonPipe(UserQueryDto, { optional: true, validate: true }))\r\n    searchQuery: UserQueryDto = {},\r\n  ) {\r\n    const result = await this.admin.getUsersPaginated(page, limit, orderBy, order, searchQuery);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(updateUserDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard, AdminGuard)\r\n  @Put(':id')\r\n  @HttpCode(200)\r\n  async updateTag(@Param('id') id: string, @Body() body: UpdateUserDto) {\r\n    const result = await this.admin.updateUser(id, body);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(deleteUserDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard, AdminGuard)\r\n  @Delete(':id')\r\n  @HttpCode(200)\r\n  async deleteUser(@Param('id') id: string) {\r\n    const result = await this.admin.deleteUser(id);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n}\r\n"],"names":["AdminController","constructor","admin","getUsersPaginated","page","limit","orderBy","order","searchQuery","result","updateTag","id","body","updateUser","deleteUser","UnionTypeValidationPipe","ParseJsonPipe","UserQueryDto","optional","validate"],"mappings":"AAAA,SAAS;;;;;+BAqCIA;;;eAAAA;;;wBApCuF;oCAG1E;wCAGI;yBACN;+BAGM;yCACU;4BAGb;oCACQ;8BAGN;+BAGC;oCAGD;uCAGS;sCAGD;6CACO;sCACP;;;;;;;;;;;;;;;AAI9B,IAAA,AAAMA,kBAAN,MAAMA;IACXC,YAAY,AAAiBC,KAAmB,CAAE;aAArBA,QAAAA;IAAsB;IAEnD,MAIMC,kBACJ,AAA6BC,IAAY,EACzC,AAA8BC,KAAa,EAC3C,AAIAC,OAAkF,EAClF,AAA8DC,KAAqB,EACnF,AACAC,cAA4B,CAAC,CAAC,EAC9B;QACA,MAAMC,SAAS,MAAM,IAAI,CAACP,KAAK,CAACC,iBAAiB,CAACC,MAAMC,OAAOC,SAASC,OAAOC;QAE/E,oBAAoB;QACpB,OAAOC;IACT;IAEA,MAIMC,UAAU,AAAaC,EAAU,EAAE,AAAQC,IAAmB,EAAE;QACpE,MAAMH,SAAS,MAAM,IAAI,CAACP,KAAK,CAACW,UAAU,CAACF,IAAIC;QAE/C,oBAAoB;QACpB,OAAOH;IACT;IAEA,MAIMK,WAAW,AAAaH,EAAU,EAAE;QACxC,MAAMF,SAAS,MAAM,IAAI,CAACP,KAAK,CAACY,UAAU,CAACH;QAE3C,oBAAoB;QACpB,OAAOF;IACT;AACF;;;;;;;;mDAlCUM,gDAAuB,CAAC;QAAC;QAAY;QAAS;QAAW;QAAc;QAAW;KAAY;iDAGhFA,gDAAuB,CAAC;QAAC;QAAO;KAAO;uDACjCC,4BAAa,CAACC,gCAAY,EAAE;QAAEC,UAAU;QAAMC,UAAU;IAAK"}