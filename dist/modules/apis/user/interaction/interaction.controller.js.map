{"version":3,"sources":["../../../../../src/modules/apis/user/interaction/interaction.controller.ts"],"sourcesContent":["// NestJS\r\nimport {\r\n  Body,\r\n  Controller,\r\n  Delete,\r\n  Get,\r\n  HttpCode,\r\n  Param,\r\n  ParseIntPipe,\r\n  Post,\r\n  Put,\r\n  Req,\r\n  UseGuards,\r\n} from '@nestjs/common';\r\n\r\n// Fastify\r\nimport { FastifyRequest as Request } from 'fastify';\r\n\r\n// Swagger\r\nimport { ApiDescriptor } from '@decorators/api-descriptor.decorator';\r\nimport { ApiTags } from '@nestjs/swagger';\r\n\r\n// Guards\r\nimport { JwtAccessAuthGuard } from '@guards/jwt-access-auth.guard';\r\n\r\n// Services\r\nimport { InteractionService } from '@apis/user/interaction/interaction.service';\r\n\r\n// Body DTOs\r\nimport { AddToCartDto } from '@apis/user/interaction/dtos/add-to-cart.dto';\r\nimport { AddToLibraryDto } from '@apis/user/interaction/dtos/add-to-library.dto';\r\nimport { AddToWishlistDto } from '@apis/user/interaction/dtos/add-to-wishlist.dto';\r\nimport { ChangeTagsDto } from '@apis/user/interaction/dtos/change-tags.dto';\r\nimport { RemoveFromCartDto } from '@apis/user/interaction/dtos/remove-from-cart.dto';\r\nimport { RemoveFromLibraryDto } from '@apis/user/interaction/dtos/remove-from-library.dto';\r\nimport { RemoveFromWishlistDto } from '@apis/user/interaction/dtos/remove-from-wishlist.dto';\r\nimport { ReviewGameDto } from '@apis/user/interaction/dtos/review-game.dto';\r\nimport { UpdateReviewDto } from '@apis/user/interaction/dtos/update-review.dto';\r\n\r\n// Swagger descriptors\r\nimport { addToCartDescriptor } from '@apis/user/interaction/api-descriptors/add-to-cart.descriptor';\r\nimport { addToLibraryDescriptor } from '@apis/user/interaction/api-descriptors/add-to-library.descriptor';\r\nimport { addToWishlistDescriptor } from '@apis/user/interaction/api-descriptors/add-to-wishlist.descriptor';\r\nimport { changeTagsDescriptor } from '@apis/user/interaction/api-descriptors/change-tags.descriptor';\r\nimport { checkReviewDescriptor } from '@apis/user/interaction/api-descriptors/check-review.descriptor';\r\nimport { getCartDescriptor } from '@apis/user/interaction/api-descriptors/get-cart.descriptor';\r\nimport { getLibraryDescriptor } from '@apis/user/interaction/api-descriptors/get-library.descriptor';\r\nimport { getReviewsDescriptor } from '@apis/user/interaction/api-descriptors/get-reviews.descriptor';\r\nimport { getTagsDescriptor } from '@apis/user/interaction/api-descriptors/get-tags.descriptor';\r\nimport { getWishlistDescriptor } from '@apis/user/interaction/api-descriptors/get-wishlist.descriptor';\r\nimport { removeFromCartDescriptor } from '@apis/user/interaction/api-descriptors/remove-from-cart.descriptor';\r\nimport { removeFromLibraryDescriptor } from '@apis/user/interaction/api-descriptors/remove-from-library.descriptor';\r\nimport { removeFromWishlistDescriptor } from '@apis/user/interaction/api-descriptors/remove-from-wishlist.descriptor';\r\nimport { reviewGameDescriptor } from '@apis/user/interaction/api-descriptors/review-game.descriptor';\r\nimport { updateReviewDescriptor } from '@apis/user/interaction/api-descriptors/update-review.descriptor';\r\n\r\n@ApiTags('User Interaction')\r\n@Controller('user/interaction')\r\nexport class InteractionController {\r\n  constructor(private readonly interactionService: InteractionService) {}\r\n\r\n  @ApiDescriptor(changeTagsDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Put('tags')\r\n  @HttpCode(200)\r\n  public async changeTags(@Req() request: Request, @Body() bodyData: ChangeTagsDto) {\r\n    const data: ChangeTagsDto & { userId: string } = {\r\n      ...bodyData,\r\n      userId: request['userId'],\r\n    };\r\n\r\n    const result = await this.interactionService.changeTags(data);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(getTagsDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Get('tags')\r\n  @HttpCode(200)\r\n  public async getTags(@Req() request: Request) {\r\n    const data: { userId: string } = { userId: request['userId'] };\r\n    const result = await this.interactionService.getTags(data);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(addToLibraryDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Post('library')\r\n  @HttpCode(201)\r\n  public async addToLibrary(@Req() request: Request, @Body() bodyData: AddToLibraryDto) {\r\n    const data: AddToLibraryDto & { userId: string } = {\r\n      ...bodyData,\r\n      userId: request['userId'],\r\n    };\r\n\r\n    const result = await this.interactionService.addToLibrary(data);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(removeFromLibraryDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Delete('library')\r\n  @HttpCode(200)\r\n  public async removeFromLibrary(@Req() request: Request, @Body() bodyData?: RemoveFromLibraryDto) {\r\n    const userId: string = request['userId'];\r\n\r\n    let result: { message: string };\r\n    if (bodyData && bodyData.itemsIds) {\r\n      const data = { userId, itemsIds: bodyData.itemsIds };\r\n      result = await this.interactionService.removeFromLibrary(data);\r\n    } else {\r\n      const data = { userId };\r\n      result = await this.interactionService.clearLibrary(data);\r\n    }\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(addToWishlistDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Post('wishlist')\r\n  @HttpCode(201)\r\n  public async addToWishlist(@Req() request: Request, @Body() bodyData: AddToWishlistDto) {\r\n    const data: AddToWishlistDto & { userId: string } = {\r\n      ...bodyData,\r\n      userId: request['userId'],\r\n    };\r\n\r\n    const result = await this.interactionService.addToWishlist(data);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(removeFromWishlistDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Delete('wishlist')\r\n  @HttpCode(200)\r\n  public async removeFromWishlist(@Req() request: Request, @Body() bodyData?: RemoveFromWishlistDto) {\r\n    const userId: string = request['userId'];\r\n\r\n    let result: { message: string };\r\n    if (bodyData && bodyData.itemsIds) {\r\n      const data = { userId, itemsIds: bodyData.itemsIds };\r\n      result = await this.interactionService.removeFromWishlist(data);\r\n    } else {\r\n      const data = { userId };\r\n      result = await this.interactionService.clearWishlist(data);\r\n    }\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(addToCartDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Post('cart')\r\n  @HttpCode(201)\r\n  public async addToCart(@Req() request: Request, @Body() bodyData: AddToCartDto) {\r\n    const data: AddToCartDto & { userId: string } = {\r\n      ...bodyData,\r\n      userId: request['userId'],\r\n    };\r\n\r\n    const result = await this.interactionService.addToCart(data);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(removeFromCartDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Delete('cart')\r\n  @HttpCode(200)\r\n  public async removeFromCart(@Req() request: Request, @Body() bodyData?: RemoveFromCartDto) {\r\n    const userId: string = request['userId'];\r\n\r\n    let result: { message: string };\r\n    if (bodyData && bodyData.itemsIds) {\r\n      const data = { userId, itemsIds: bodyData.itemsIds };\r\n      result = await this.interactionService.removeFromCart(data);\r\n    } else {\r\n      const data = { userId };\r\n      result = await this.interactionService.clearCart(data);\r\n    }\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(getLibraryDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Get('library')\r\n  @HttpCode(200)\r\n  public async getLibrary(@Req() request: Request) {\r\n    const data: { userId: string } = { userId: request['userId'] };\r\n\r\n    const result = await this.interactionService.getLibrary(data);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(getCartDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Get('cart')\r\n  @HttpCode(200)\r\n  public async getCart(@Req() request: Request) {\r\n    const data: { userId: string } = { userId: request['userId'] };\r\n\r\n    const result = await this.interactionService.getCart(data);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(getWishlistDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Get('wishlist')\r\n  @HttpCode(200)\r\n  public async getWishlist(@Req() request: Request) {\r\n    const data: { userId: string } = { userId: request['userId'] };\r\n\r\n    const result = await this.interactionService.getWishlist(data);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(reviewGameDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Post('review')\r\n  @HttpCode(201)\r\n  public async reviewGame(@Req() request: Request, @Body() bodyData: ReviewGameDto) {\r\n    const data: ReviewGameDto & { userId: string } = {\r\n      ...bodyData,\r\n      userId: request['userId'],\r\n    };\r\n\r\n    const result = await this.interactionService.reviewGame(data);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(updateReviewDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Put('review')\r\n  @HttpCode(200)\r\n  public async updateReview(@Body() bodyData: UpdateReviewDto) {\r\n    const result = await this.interactionService.updateReview(bodyData);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(checkReviewDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Get('check-review/:gameId')\r\n  @HttpCode(200)\r\n  public async checkReview(@Req() request: Request, @Param('gameId', ParseIntPipe) gameId: number) {\r\n    const data: { userId: string; gameId: number } = {\r\n      userId: request['userId'],\r\n      gameId,\r\n    };\r\n\r\n    const result = await this.interactionService.hasReviewedGame(data);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n\r\n  @ApiDescriptor(getReviewsDescriptor)\r\n  @UseGuards(JwtAccessAuthGuard)\r\n  @Get('reviews')\r\n  @HttpCode(200)\r\n  public async getReviews(@Req() request: Request) {\r\n    const data: { userId: string } = { userId: request['userId'] };\r\n    const result = await this.interactionService.getReviews(data);\r\n\r\n    // Send the response\r\n    return result;\r\n  }\r\n}\r\n"],"names":["InteractionController","constructor","interactionService","changeTags","request","bodyData","data","userId","result","getTags","addToLibrary","removeFromLibrary","itemsIds","clearLibrary","addToWishlist","removeFromWishlist","clearWishlist","addToCart","removeFromCart","clearCart","getLibrary","getCart","getWishlist","reviewGame","updateReview","checkReview","gameId","hasReviewedGame","getReviews"],"mappings":"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"}