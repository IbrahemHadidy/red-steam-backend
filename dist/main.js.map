{"version":3,"sources":["../src/main.ts"],"sourcesContent":["// NestJS\nimport { NestFactory } from '@nestjs/core';\n\n// Main entry point of the application (App Module)\nimport { AppModule } from '@modules/app.module';\n\n// Fastify\nimport { FastifyAdapter } from '@nestjs/platform-fastify';\n\n// Swagger\nimport { DocumentBuilder, SwaggerModule } from '@nestjs/swagger';\nimport { SwaggerTheme, SwaggerThemeNameEnum } from 'swagger-themes';\n\n// Types\nimport type { NestFastifyApplication } from '@nestjs/platform-fastify';\nimport type { SwaggerCustomOptions } from '@nestjs/swagger';\n\n// Declare 'module' variable for hot module replacement (HMR) support\ndeclare const module: NodeJS.Module;\n\nclass AppBootstrapper {\n  private readonly port: number;\n\n  constructor() {\n    this.port = parseInt(process.env.PORT) || 4000;\n  }\n\n  public async bootstrap() {\n    // Create Nest application instance (Fastify adapter)\n    const app = await NestFactory.create<NestFastifyApplication>(AppModule, new FastifyAdapter(), { snapshot: true });\n\n    // Configure Swagger documentation\n    const config = new DocumentBuilder()\n      .setTitle('Red Steam API')\n      .setDescription('A backend API for Red Steam')\n      .setVersion('1.0')\n      .addCookieAuth('accessToken', {\n        type: 'apiKey',\n        name: 'accessToken',\n        in: 'cookie',\n      })\n      .addCookieAuth('refreshToken', {\n        type: 'apiKey',\n        name: 'refreshToken',\n        in: 'cookie',\n      })\n      .build();\n\n    // Configure custom Swagger theme\n    const theme = new SwaggerTheme();\n    const options: SwaggerCustomOptions = {\n      customCss: theme.getBuffer(SwaggerThemeNameEnum.DARK),\n      jsonDocumentUrl: 'json',\n      yamlDocumentUrl: 'yaml',\n    };\n\n    // Create Swagger document\n    const document = SwaggerModule.createDocument(app, config);\n\n    // Setup Swagger UI endpoint\n    SwaggerModule.setup('api', app, document, options);\n\n    // Register configurations and middleware to the application instance\n    await AppModule.register(app);\n\n    // Start the Nest application on specified port\n    await app.listen(this.port, '0.0.0.0');\n\n    // Enable hot module replacement (HMR) support for development\n    if (process.env.NODE_ENV === 'development' && module.hot) {\n      module.hot.accept();\n      module.hot.dispose(() => app.close());\n    }\n  }\n}\n\n// Instantiate and run the application\nconst appBootstrapper = new AppBootstrapper();\nappBootstrapper.bootstrap();\n"],"names":["AppBootstrapper","constructor","port","parseInt","process","env","PORT","bootstrap","app","NestFactory","create","AppModule","FastifyAdapter","snapshot","config","DocumentBuilder","setTitle","setDescription","setVersion","addCookieAuth","type","name","in","build","theme","SwaggerTheme","options","customCss","getBuffer","SwaggerThemeNameEnum","DARK","jsonDocumentUrl","yamlDocumentUrl","document","SwaggerModule","createDocument","setup","register","listen","NODE_ENV","module","hot","accept","dispose","close","appBootstrapper"],"mappings":"AAAA,SAAS;;;;;sBACmB;2BAGF;iCAGK;yBAGgB;+BACI;AASnD,IAAA,AAAMA,kBAAN,MAAMA;IAGJC,aAAc;QACZ,IAAI,CAACC,IAAI,GAAGC,SAASC,QAAQC,GAAG,CAACC,IAAI,KAAK;IAC5C;IAEA,MAAaC,YAAY;QACvB,qDAAqD;QACrD,MAAMC,MAAM,MAAMC,iBAAW,CAACC,MAAM,CAAyBC,oBAAS,EAAE,IAAIC,+BAAc,IAAI;YAAEC,UAAU;QAAK;QAE/G,kCAAkC;QAClC,MAAMC,SAAS,IAAIC,wBAAe,GAC/BC,QAAQ,CAAC,iBACTC,cAAc,CAAC,+BACfC,UAAU,CAAC,OACXC,aAAa,CAAC,eAAe;YAC5BC,MAAM;YACNC,MAAM;YACNC,IAAI;QACN,GACCH,aAAa,CAAC,gBAAgB;YAC7BC,MAAM;YACNC,MAAM;YACNC,IAAI;QACN,GACCC,KAAK;QAER,iCAAiC;QACjC,MAAMC,QAAQ,IAAIC,2BAAY;QAC9B,MAAMC,UAAgC;YACpCC,WAAWH,MAAMI,SAAS,CAACC,mCAAoB,CAACC,IAAI;YACpDC,iBAAiB;YACjBC,iBAAiB;QACnB;QAEA,0BAA0B;QAC1B,MAAMC,WAAWC,sBAAa,CAACC,cAAc,CAAC3B,KAAKM;QAEnD,4BAA4B;QAC5BoB,sBAAa,CAACE,KAAK,CAAC,OAAO5B,KAAKyB,UAAUP;QAE1C,qEAAqE;QACrE,MAAMf,oBAAS,CAAC0B,QAAQ,CAAC7B;QAEzB,+CAA+C;QAC/C,MAAMA,IAAI8B,MAAM,CAAC,IAAI,CAACpC,IAAI,EAAE;QAE5B,8DAA8D;QAC9D,IAAIE,QAAQC,GAAG,CAACkC,QAAQ,KAAK,iBAAiBC,OAAOC,GAAG,EAAE;YACxDD,OAAOC,GAAG,CAACC,MAAM;YACjBF,OAAOC,GAAG,CAACE,OAAO,CAAC,IAAMnC,IAAIoC,KAAK;QACpC;IACF;AACF;AAEA,sCAAsC;AACtC,MAAMC,kBAAkB,IAAI7C;AAC5B6C,gBAAgBtC,SAAS"}